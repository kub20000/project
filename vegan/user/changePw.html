<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</title>
  <link rel="stylesheet" href="style.css">
</head>

<body class="changePw">
  <main class="form-container">
    <h2 style="align-self: flex-start; color: black;">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½<img src="/vegan/pw.png" alt="ë¹„ë°€ë²ˆí˜¸" width="30"></h2>
    <form id="changePwForm">
      <input class="changePw" type="password" id="nowPw" placeholder="í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”." required>
      <div style="position: relative;">
        <input type="password" id="newPw" placeholder="ìƒˆë¡œìš´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”." required>
        <div id="capsLockWarning" class="caps-warning">Caps Lockì´ ì¼œì ¸ ìˆìŠµë‹ˆë‹¤!</div>
        <div id="pwStrength" class="strength"></div>
      </div>
      <input type="password" id="confirmPw" placeholder="ë‹¤ì‹œ í•œ ë²ˆ ì…ë ¥í•˜ì„¸ìš”." required>
      <button class="changePw" type="submit">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</button>
    </form>
  </main>

  <script>
    const form = document.getElementById("changePwForm");
    const newPwInput = document.getElementById("newPw");
    const confirmPwInput = document.getElementById("confirmPw");
    const strengthDiv = document.getElementById("pwStrength");
    const capsLockWarning = document.getElementById("capsLockWarning");

    // Caps Lock ê°ì§€
    newPwInput.addEventListener("keyup", (e) => {
      capsLockWarning.style.display = e.getModifierState("CapsLock") ? "block" : "none";
    });

    // ë¹„ë°€ë²ˆí˜¸ ì•ˆì „ë„ ê²€ì¦
    newPwInput.addEventListener("input", () => {
      const pwd = newPwInput.value;
      let strength = "ì•½í•¨";
      let color = "red";

      const regexStrong = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/;
      const regexMedium = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{6,}$/;

      if (regexStrong.test(pwd)) {
        strength = "ê°•í•¨";
        color = "green";
      } else if (regexMedium.test(pwd)) {
        strength = "ë³´í†µ";
        color = "orange";
      }

      strengthDiv.textContent = `ë¹„ë°€ë²ˆí˜¸ ì•ˆì „ë„: ${strength}`;
      strengthDiv.style.color = color;
    });

    // í¼ ì œì¶œ
    form.addEventListener("submit", function (event) {
      event.preventDefault();

      const newPw = newPwInput.value;
      const confirmPw = confirmPwInput.value;

      if (newPw !== confirmPw) {
        alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }

      // ì¶”ê°€ ì•ˆì „ë„ ì²´í¬
      const regexStrong = /^(?=.*[a-z])(?=.*\d)(?=.*[!@#$%^&*+\-=_]).{8,}$/;
      if (!regexStrong.test(newPw)) {
        alert("ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 8ì ì´ìƒ, ì†Œë¬¸ì/ìˆ«ì/íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.");
        return;
      }

      alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì •ìƒì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.");
      // ğŸ‘‰ ì„œë²„ ì—°ë™ì´ í•„ìš”í•˜ë©´ ì—¬ê¸°ì„œ fetch/AJAX ì¶”ê°€
    });
  </script>
</body>

</html>